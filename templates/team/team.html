{% extends 'header.html' %}
{% load static %}
{% block team %}
    <div class="influence-finder">
        <div class="container-fluid dashboard-content">
            <!-- ============================================================== -->
            <!-- pageheader -->
            <!-- ============================================================== -->
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                    <div class="page-header">
                        <h3 class="mb-2">团队管理</h3>
                        <p class="pageheader-text">Proin placerat ante duiullam scelerisque a velit ac porta, fusce sit
                            amet vestibulum mi. Morbi lobortis pulvinar quam.</p>
                        <div class="page-breadcrumb">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="{% url 'create_team' %}"
                                                                   class="breadcrumb-link">创建团队</a></li>
                                    <li class="breadcrumb-item active" aria-current="page">新建一个团队开始 ba ~~~
                                    </li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ============================================================== -->
            <!-- end pageheader -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- content -->
            <!-- ============================================================== -->
            <div class="row">
                <!-- ============================================================== -->
                <!-- search bar  -->
                <!-- ============================================================== -->
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                    <div class="card">
                        <div class="card-body">
                            <form>
                                <input class="form-control form-control-lg" type="search" placeholder="Search"
                                       aria-label="Search">
                                <button class="btn btn-primary search-btn" type="submit">Search</button>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- ============================================================== -->
                <!-- end search bar  -->
                <!-- ============================================================== -->
                <div class="col-xl-12 col-lg-8 col-md-8 col-sm-12 col-12">
                    <!-- ============================================================== -->
                    <!-- card influencer one -->
                    <!-- ============================================================== -->
                    {% for foo in object_list %}
                        <div class="card">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-xl-9 col-lg-12 col-md-12 col-sm-12 col-12">
                                        <div class="user-avatar float-xl-left pr-4 float-none">
                                            <img src="{% static 'assets/images/login_img.png' %}" alt="User Avatar"
                                                 class="rounded-circle user-avatar-xl">
                                        </div>
                                        <div class="pl-xl-3">
                                            <div class="m-b-0">
                                                <div class="user-avatar-name d-inline-block">
                                                    <h2 class="font-24 m-b-10">{{ foo.name }}</h2>
                                                </div>
                                                <div class="rating-star d-inline-block pl-xl-2 mb-2 mb-xl-0">
                                                    <i class="fa fa-fw fa-star"></i>
                                                    <i class="fa fa-fw fa-star"></i>
                                                    <i class="fa fa-fw fa-star"></i>
                                                    <i class="fa fa-fw fa-star"></i>
                                                    <i class="fa fa-fw fa-star"></i>
                                                    <p class="d-inline-block text-dark">14 Reviews </p>
                                                </div>
                                            </div>
                                            <div class="user-avatar-address">
                                                <p class="mb-2">{{ foo.creator }}<span class="m-l-10">于<span
                                                        class="m-l-20">{{ foo.create_time }}<span
                                                        class="m-l-10"> 创建</span></span></span>
                                                </p>
                                                <div class="mt-3">
                                                    <a href="/team/edit/{{ foo.id }}/" class="mr-1 badge badge-light">编辑</a>
                                                    <a href="javascript:void(0)" class="mr-1 badge badge-light"
                                                       onclick="join({{ foo.id }})">审核/加入</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-3 col-lg-12 col-md-12 col-sm-12 col-12">
                                        <div class="float-xl-right float-none mt-xl-0 mt-4">
                                            <a href="#" class="btn-wishlist m-r-10"><i class="far fa-star"></i></a>
                                            <a href="javascript:void(0)" onclick="go_team({{ foo.id }})"
                                               class="btn btn-secondary">GO Team</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="border-top user-social-box">
                                <div class="user-social-media d-xl-inline-block "><span class="mr-2 twitter-color"> <i
                                        class="fab fa-twitter-square"></i></span><span>13,291</span></div>
                                <div class="user-social-media d-xl-inline-block"><span class="mr-2  pinterest-color"> <i
                                        class="fab fa-pinterest-square"></i></span><span>84,019</span></div>
                                <div class="user-social-media d-xl-inline-block"><span class="mr-2 instagram-color"> <i
                                        class="fab fa-instagram"></i></span><span>12,300</span></div>
                                <div class="user-social-media d-xl-inline-block"><span class="mr-2  facebook-color"> <i
                                        class="fab fa-facebook-square "></i></span><span>92,920</span></div>
                                <div class="user-social-media d-xl-inline-block"><span class="mr-2 medium-color"> <i
                                        class="fab fa-medium"></i></span><span>291</span></div>
                                <div class="user-social-media d-xl-inline-block"><span class="mr-2 youtube-color"> <i
                                        class="fab fa-youtube"></i></span><span>1291</span></div>
                            </div>
                        </div>
                        <div class="alert alert-warning alert-dismissible fade show" role="alert" id="error{{ foo.id }}"
                             style="display: none">
                            <span id="error-msg-{{ foo.id }}"></span>
                            <a href="#" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </a>
                        </div>
                    {% endfor %}

                    <!-- ============================================================== -->
                    <!-- end card influencer one -->
                    <!-- ============================================================== -->
                </div>
            </div>
            {% if is_paginated %}
                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                        <nav aria-label="Page navigation example">
                            <ul class="pagination">
                                {#                                <li class="page-item"><a class="page-link" href="#">Previous</a></li>#}
                                {% if first %}
                                    <li class="page-item"><a class="page-link" href="?page=1">1</a></li>
                                {% endif %}
                                {% if left %}
                                    {% if left_has_more %}
                                        <li class="page-item"><a class="page-link" href="javascript:void(0)">...</a>
                                        </li>
                                    {% endif %}
                                    {% for i in left %}
                                        <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                                    {% endfor %}
                                {% endif %}
                                <li class="page-item active"><a class="page-link"
                                                                href="javascript:void(0)">{{ page_obj.number }}</a>
                                </li>
                                {% if right %}
                                    {% for i in right %}
                                        <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                                    {% endfor %}
                                    {% if right_has_more %}
                                        <li class="page-item"><a class="page-link" href="javascript:void(0)">...</a>
                                        </li>
                                    {% endif %}
                                {% endif %}
                                {% if last %}
                                    <li class="page-item"><a class="page-link"
                                                             href="?page={{ paginator.num_pages }}">{{ paginator.num_pages }}</a>
                                    </li>
                                {% endif %}
                            </ul>
                        </nav>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block js %}
    <script type="application/javascript">
        function join(t_id) {
            $.ajax({
                type: "post",
                url: "{% url 'team_join' %}",
                data: {
                    "tid": t_id
                },
                success: function (data) {
                    console.log(data);
                    var msg = $("#error-msg-" + t_id);
                    if (data.code == 999) {
                        msg.html(data.message);
                        msg.addClass('text-danger');
                        $("#error" + t_id).show();
                    } else if (data.code == 200) {
                        msg.html(data.message);
                        msg.addClass('text-success');
                        $("#error" + t_id).show();
                    } else if (data.code == 403) {
                        window.location.href = 'http://localhost:8000/team/apply/' + t_id + '/';
                    }
                }
            })
        }
        // /base/home/{{ foo.id }}/
        function go_team(t_id) {
            $.ajax({
                type: "post",
                url: "{% url 'team_go' %}",
                data: {
                    "tid": t_id
                },
                success: function (data) {
                    console.log(data);
                    var msg = $("#error-msg-" + t_id);
                    if (data.code == 999) {
                        if (data.data.status) {
                            window.location.href = 'http://localhost:8000/admin/index/' + t_id + '/';
                        } else {
                            msg.addClass('text-danger');
                            msg.html(data.message);
                            $("#error" + t_id).show();
                        }
                    }
                }
            })
        }
    </script>
{% endblock %}